(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{117:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(8),o=n.n(c),i=n(26),s=n(13),l=n(73),u=n(12),b=n(74),d=n.n(b),j=n(2);var h=function(e){var t=e.children;return Object(j.jsx)("div",{className:d.a.container,children:t})},p={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,color:"#2A363B"},activeLink:{color:"#E84A5F"}},f=function(){return Object(j.jsxs)("nav",{children:[Object(j.jsx)(i.b,{to:"/",exact:!0,style:p.link,activeStyle:p.activeLink,children:"Home"}),Object(j.jsx)(i.b,{to:"/contacts",exact:!0,style:p.link,activeStyle:p.activeLink,children:"Contacts"})]})},O=n(19),m=n.n(O),g=n(31),x=n(24),v=n.n(x),y=n(9);v.a.defaults.baseURL="https://connections-api.herokuapp.com";var k=function(e){v.a.defaults.headers.common.Authorization="Bearer ".concat(e)},C=function(){v.a.defaults.headers.common.Authorization=""},w=Object(y.c)("auth/register",function(){var e=Object(g.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.post("/users/signup",t);case 3:return n=e.sent,a=n.data,k(a.token),e.abrupt("return",a);case 9:e.prev=9,e.t0=e.catch(0),console.log("error=",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),S=Object(y.c)("auth/login",function(){var e=Object(g.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.post("/users/login",t);case 3:return n=e.sent,a=n.data,k(a.token),e.abrupt("return",a);case 9:e.prev=9,e.t0=e.catch(0),console.log("error=",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),L=Object(y.c)("auth/logout",Object(g.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.post("/users/logout");case 3:C(),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))),A=Object(y.c)("auth/refresh",function(){var e=Object(g.a)(m.a.mark((function e(t,n){var a,r,c,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.getState(),null!==(r=a.auth.token)){e.next=4;break}return e.abrupt("return",n.rejectWithValue());case 4:return k(r),e.prev=5,e.next=8,v.a.get("/users/current");case 8:return c=e.sent,o=c.data,e.abrupt("return",o);case 13:e.prev=13,e.t0=e.catch(5);case 15:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t,n){return e.apply(this,arguments)}}()),I={register:w,logOut:L,logIn:S,fetchCurrentUser:A},B={getIsLoggedIn:function(e){return e.auth.isLoggedIn},getUsername:function(e){return e.auth.user.name}},W={container:{display:"flex",alignItems:"center"},avatar:{marginRight:4},name:{fontWeight:700,marginRight:12}};function R(){var e=Object(s.b)(),t=Object(s.c)(B.getUsername);return Object(j.jsxs)("div",{style:W.container,children:[Object(j.jsxs)("span",{style:W.name,children:["Hello, ",t]}),Object(j.jsx)("button",{type:"button",onClick:function(){return e(I.logOut())},children:"Logout"})]})}var E={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,color:"#2A363B"},activeLink:{color:"#E84A5F"}},Z=function(){return Object(j.jsxs)("div",{children:[Object(j.jsx)(i.b,{to:"/register",exact:!0,style:E.link,activeStyle:E.activeLink,children:"Register"}),Object(j.jsx)(i.b,{to:"/login",exact:!0,style:E.link,activeStyle:E.activeLink,children:"Login"})]})},T={header:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #2A363B"}},z=function(){var e=Object(s.c)(B.getIsLoggedIn);return Object(j.jsxs)("header",{style:T.header,children:[Object(j.jsx)(f,{}),e?Object(j.jsx)(R,{}):Object(j.jsx)(Z,{})]})},F={container:{minHeight:"calc(100vh - 50px)",display:"flex",alignItems:"center",justifyContent:"center"},title:{fontWeight:500,fontSize:48,textAlign:"center"}},_=function(){return Object(j.jsx)("div",{style:F.container,children:Object(j.jsxs)("h1",{style:F.title,children:["Welcome page of the service"," "]})})},q=n(53),D=n(149),U=n(148),N={name:"",email:"",password:""},H=function(){var e=Object(s.b)(),t=Object(a.useCallback)((function(e){var t={};return e.name?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(t.email="Invalid email address"):t.name="Required",t}),[]),n=Object(a.useCallback)((function(t,n){(0,n.setSubmitting)(!1),e(I.register(t))}),[e]);return Object(j.jsxs)("div",{style:{marginLeft:"40px",width:"400px"},children:[Object(j.jsx)("h1",{children:"Registration"}),Object(j.jsx)(q.a,{initialValues:N,validate:t,onSubmit:n,children:function(e){var t=e.values,n=e.errors,a=e.touched,r=e.handleChange,c=e.handleSubmit,o=e.handleBlur,i=e.isSubmitting;return Object(j.jsxs)("form",{onSubmit:c,autoComplete:"off",children:[Object(j.jsx)(U.a,{fullWidth:!0,id:"name",name:"name",label:"Name",type:"text",value:t.name,onChange:r,onBlur:o,error:a.name&&Boolean(n.name),helperText:a.name&&n.name}),Object(j.jsx)(U.a,{fullWidth:!0,id:"email",name:"email",label:"Email",type:"email",value:t.email,onChange:r,onBlur:o,error:a.email&&Boolean(n.email),helperText:a.email&&n.email}),Object(j.jsx)(U.a,{fullWidth:!0,id:"password",name:"password",label:"Password",type:"password",value:t.password,onBlur:o,onChange:r,error:a.password&&Boolean(n.password),helperText:a.password&&n.password}),Object(j.jsx)(D.a,{color:"primary",variant:"contained",fullWidth:!0,type:"submit",disabled:i||!(Object.keys(a).length===Object.keys(N).length&&0===Object.keys(n).length),children:"Submit"})]})}})]})},V={email:"",password:""},J=function(){var e=Object(s.b)(),t=Object(a.useCallback)((function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Required",t}),[]),n=Object(a.useCallback)((function(t,n){(0,n.setSubmitting)(!1),e(I.logIn(t))}),[e]);return Object(j.jsxs)("div",{style:{marginLeft:"40px",width:"400px"},children:[Object(j.jsx)("h1",{children:"Login"}),Object(j.jsx)(q.a,{initialValues:V,validate:t,onSubmit:n,children:function(e){var t=e.values,n=e.errors,a=e.touched,r=e.handleChange,c=e.handleSubmit,o=e.handleBlur,i=e.isSubmitting;return Object(j.jsxs)("form",{onSubmit:c,autoComplete:"off",children:[Object(j.jsx)(U.a,{fullWidth:!0,id:"email",name:"email",label:"Email",type:"email",value:t.email,onChange:r,onBlur:o,error:a.email&&Boolean(n.email),helperText:a.email&&n.email}),Object(j.jsx)(U.a,{fullWidth:!0,id:"password",name:"password",label:"Password",type:"password",value:t.password,onBlur:o,onChange:r,error:a.password&&Boolean(n.password),helperText:a.password&&n.password}),Object(j.jsx)(D.a,{color:"primary",variant:"contained",fullWidth:!0,type:"submit",disabled:i||!(Object.keys(a).length===Object.keys(V).length&&0===Object.keys(n).length),children:"Submit"})]})}})]})},P=n(61),$=n(78),M=n.n($);var G=function(e){var t=e.onSubmit,n=Object(a.useState)(""),r=Object(P.a)(n,2),c=r[0],o=r[1],i=Object(a.useState)(""),s=Object(P.a)(i,2),l=s[0],u=s[1];return Object(j.jsxs)("form",{className:M.a.form,style:{marginBottom:"32px"},onSubmit:function(e){e.preventDefault(),t(c,l),o(""),u("")},children:[Object(j.jsx)("p",{children:"Name"}),Object(j.jsx)("input",{type:"text",name:"name",value:c,pattern:"^[a-zA-Z\u0430-\u044f\u0410-\u042f]+(([' -][a-zA-Z\u0430-\u044f\u0410-\u042f ])?[a-zA-Z\u0430-\u044f\u0410-\u042f]*)*$",title:"\u0418\u043c\u044f \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 \u0431\u0443\u043a\u0432, \u0430\u043f\u043e\u0441\u0442\u0440\u043e\u0444\u0430, \u0442\u0438\u0440\u0435 \u0438 \u043f\u0440\u043e\u0431\u0435\u043b\u043e\u0432. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan \u0438 \u0442. \u043f.",required:!0,onChange:function(e){o(e.currentTarget.value)}}),Object(j.jsx)("p",{children:"Number"}),Object(j.jsx)("input",{type:"tel",value:l,name:"number",pattern:"\\+?\\d{1,4}?[-.\\s]?\\(?\\d{1,3}?\\)?[-.\\s]?\\d{1,4}[-.\\s]?\\d{1,4}[-.\\s]?\\d{1,9}",title:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0446\u0438\u0444\u0440 \u0438 \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043f\u0440\u043e\u0431\u0435\u043b\u044b, \u0442\u0438\u0440\u0435, \u043a\u0440\u0443\u0433\u043b\u044b\u0435 \u0441\u043a\u043e\u0431\u043a\u0438 \u0438 \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0441 +",required:!0,onChange:function(e){u(e.currentTarget.value)}}),Object(j.jsxs)("div",{children:[Object(j.jsx)("br",{}),Object(j.jsx)("button",{type:"submit",children:"Add contact"})]})]})};var K=function(e){var t=e.onChange;return Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{children:"Find contacts by name"}),Object(j.jsx)("input",{type:"text",onChange:function(e){t(e.currentTarget.value)}})]})};var Q=function(e){var t=e.contacts,n=e.onDelete;return Object(j.jsx)("ul",{children:t.map((function(e){return Object(j.jsxs)("li",{children:[e.name," ",e.number,Object(j.jsx)("button",{type:"button",onClick:function(){n(e.id)},children:"Delete"})]},e.id)}))})},X=Object(y.b)("contacts/fetchContactsRequest"),Y=Object(y.b)("contacts/fetchContactsSuccess"),ee=Object(y.b)("contacts/fetchContactsError"),te=Object(y.b)("contacts/addContactRequest"),ne=Object(y.b)("contacts/addContactSuccess"),ae=Object(y.b)("contacts/addContactError"),re=Object(y.b)("contacts/deleteContactRequest"),ce=Object(y.b)("contacts/deleteContactSuccess"),oe=Object(y.b)("contacts/deleteContactError"),ie=Object(y.b)("contacts/changeFilter"),se={fetchContacts:function(){return function(){var e=Object(g.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(X()),e.prev=1,e.next=4,v.a.get("/contacts");case 4:n=e.sent,a=n.data,t(Y(a)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t(ee(e.t0.message));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},addContact:function(e){return function(){var t=Object(g.a)(m.a.mark((function t(n){var a,r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(te()),t.prev=1,t.next=4,v.a.post("/contacts",e);case 4:a=t.sent,r=a.data,n(ne(r)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),n(ae(t.t0.message));case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},deleteContact:function(e){return function(){var t=Object(g.a)(m.a.mark((function t(n){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(re()),t.prev=1,t.next=4,v.a.delete("/contacts/".concat(e));case 4:n(ce(e)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),n(oe(t.t0.message));case 10:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}()}},le=se,ue=function(e){return e.contacts.filter},be=function(e){return e.contacts.items},de={getFilter:ue,getAllContacts:be,getFilteredContacts:function(e){var t=be(e),n=ue(e);return t.filter((function(e){return e.name.toLowerCase().includes(n.toLowerCase())}))}};var je,he,pe=function(){var e=Object(s.c)(de.getAllContacts),t=Object(s.c)(de.getFilteredContacts),n=Object(s.b)();return Object(a.useEffect)((function(){n(le.fetchContacts())}),[n]),Object(j.jsxs)(h,{children:[Object(j.jsx)("h1",{children:"Phonebook"}),Object(j.jsx)(G,{onSubmit:function(t,a){e.filter((function(e){return e.name===t})).length>0?alert(t+" is already in contacts"):n(le.addContact({name:t,number:a}))}}),Object(j.jsx)("h2",{children:"Contacts"}),Object(j.jsx)(K,{onChange:function(e){n(ie(e))}}),Object(j.jsx)(Q,{contacts:t,onDelete:function(e){n(le.deleteContact(e))}})]})},fe=n(36),Oe=n(56),me=["component"],ge=function(e){var t=e.component,n=Object(Oe.a)(e,me),a=Object(s.c)(B.getIsLoggedIn);return Object(j.jsx)(u.b,Object(fe.a)(Object(fe.a)({},n),{},{render:function(e){return a?Object(j.jsx)(t,Object(fe.a)({},e)):Object(j.jsx)(u.a,{to:"/login"})}}))},xe=["component"],ve=function(e){var t=e.component,n=Object(Oe.a)(e,xe),a=Object(s.c)(B.getIsLoggedIn);return Object(j.jsx)(u.b,Object(fe.a)(Object(fe.a)({},n),{},{render:function(e){return a?Object(j.jsx)(u.a,{to:"/"}):Object(j.jsx)(t,Object(fe.a)({},e))}}))},ye=function(){var e=Object(s.b)();return Object(a.useEffect)((function(){e(I.fetchCurrentUser())}),[e]),Object(j.jsxs)(h,{children:[Object(j.jsx)(z,{}),Object(j.jsxs)(u.d,{children:[Object(j.jsx)(u.b,{component:_,exact:!0,path:"/"}),Object(j.jsx)(ve,{component:H,path:"/register"}),Object(j.jsx)(ve,{component:J,path:"/login"}),Object(j.jsx)(ge,{component:pe,path:"/contacts"})]})]})},ke=n(55),Ce=n(33),we=n(79),Se=n.n(we),Le=n(23),Ae=n(18),Ie=Object(y.d)([],(je={},Object(Le.a)(je,Y,(function(e,t){return t.payload})),Object(Le.a)(je,ne,(function(e,t){var n=t.payload;return[].concat(Object(ke.a)(e),[n])})),Object(Le.a)(je,ce,(function(e,t){var n=t.payload;return e.filter((function(e){return e.id!==n}))})),je)),Be=Object(y.d)("",Object(Le.a)({},ie,(function(e,t){return t.payload}))),We=Object(Ae.b)({items:Ie,filter:Be}),Re=Object(y.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1},extraReducers:(he={},Object(Le.a)(he,I.register.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0})),Object(Le.a)(he,I.logIn.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0})),Object(Le.a)(he,I.logOut.fulfilled,(function(e,t){e.user={name:null,email:null},e.token=null,e.isLoggedIn=!1})),Object(Le.a)(he,I.fetchCurrentUser.fulfilled,(function(e,t){e.user=t.payload,e.isLoggedIn=!0})),he)}).reducer,Ee=Object(ke.a)(Object(y.f)({serializableCheck:{ignoredActions:[Ce.a,Ce.f,Ce.b,Ce.c,Ce.d,Ce.e]}})),Ze={key:"auth",storage:Se.a,whitelist:["token"]},Te=Object(y.a)({reducer:{auth:Object(Ce.g)(Ze,Re),contacts:We},middleware:Ee,devTools:!1}),ze=Object(Ce.h)(Te);n(117);o.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(s.a,{store:Te,children:Object(j.jsx)(l.a,{loading:null,persistor:ze,children:Object(j.jsx)(i.a,{children:Object(j.jsx)(ye,{})})})})}),document.getElementById("root"))},74:function(e,t,n){e.exports={container:"Container_container__36VH0"}},78:function(e,t,n){e.exports={form:"ContactForm_form__20hZk"}}},[[118,1,2]]]);
//# sourceMappingURL=main.3cd81319.chunk.js.map
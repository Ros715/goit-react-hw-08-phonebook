(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{113:function(e,t,n){},114:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(8),o=n.n(c),i=n(24),s=n(17),l=n(70),u=n(12),b=n(71),d=n.n(b),j=n(3);var h=function(e){var t=e.children;return Object(j.jsx)("div",{className:d.a.container,children:t})},p={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,color:"#2A363B"},activeLink:{color:"#E84A5F"}},O=function(){return Object(j.jsxs)("nav",{children:[Object(j.jsx)(i.b,{to:"/",exact:!0,style:p.link,activeStyle:p.activeLink,children:"Home"}),Object(j.jsx)(i.b,{to:"/contacts",exact:!0,style:p.link,activeStyle:p.activeLink,children:"Contacts"})]})},f=n(29),m=n.n(f),g=n(44),x=n(35),v=n.n(x),y=n(9);v.a.defaults.baseURL="https://connections-api.herokuapp.com";var k=function(e){v.a.defaults.headers.common.Authorization="Bearer ".concat(e)},w=function(){v.a.defaults.headers.common.Authorization=""},C=Object(y.c)("auth/register",function(){var e=Object(g.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("credentials=",t),e.next=4,v.a.post("/users/signup",t);case 4:return n=e.sent,a=n.data,console.log("data=",a),k(a.token),e.abrupt("return",a);case 11:e.prev=11,e.t0=e.catch(0),console.log("error=",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()),I=Object(y.c)("auth/login",function(){var e=Object(g.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("credentials=",t),e.next=4,v.a.post("/users/login",t);case 4:return n=e.sent,a=n.data,console.log("data=",a),k(a.token),e.abrupt("return",a);case 11:e.prev=11,e.t0=e.catch(0),console.log("error=",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()),S=Object(y.c)("auth/logout",Object(g.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.post("/users/logout");case 3:w(),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))),L=Object(y.c)("auth/refresh",function(){var e=Object(g.a)(m.a.mark((function e(t,n){var a,r,c,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.getState(),null!==(r=a.auth.token)){e.next=5;break}return console.log("No token found, escape from fetchCurrentUser"),e.abrupt("return",n.rejectWithValue());case 5:return k(r),e.prev=6,e.next=9,v.a.get("/users/current");case 9:return c=e.sent,o=c.data,e.abrupt("return",o);case 14:e.prev=14,e.t0=e.catch(6);case 16:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t,n){return e.apply(this,arguments)}}()),B={register:C,logOut:S,logIn:I,fetchCurrentUser:L},A={getIsLoggedIn:function(e){return e.auth.isLoggedIn},getUsername:function(e){return e.auth.user.name}},W={container:{display:"flex",alignItems:"center"},avatar:{marginRight:4},name:{fontWeight:700,marginRight:12}};function R(){var e=Object(s.b)(),t=Object(s.c)(A.getUsername);return Object(j.jsxs)("div",{style:W.container,children:[Object(j.jsxs)("span",{style:W.name,children:["Hello, ",t]}),Object(j.jsx)("button",{type:"button",onClick:function(){return e(B.logOut())},children:"Logout"})]})}var E,T,U={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,color:"#2A363B"},activeLink:{color:"#E84A5F"}},Z=function(){return Object(j.jsxs)("div",{children:[Object(j.jsx)(i.b,{to:"/register",exact:!0,style:U.link,activeStyle:U.activeLink,children:"Register"}),Object(j.jsx)(i.b,{to:"/login",exact:!0,style:U.link,activeStyle:U.activeLink,children:"Login"})]})},q={header:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #2A363B"}},V=function(){var e=Object(s.c)(A.getIsLoggedIn);return Object(j.jsxs)("header",{style:q.header,children:[Object(j.jsx)(O,{}),e?Object(j.jsx)(R,{}):Object(j.jsx)(Z,{})]})},_={container:{minHeight:"calc(100vh - 50px)",display:"flex",alignItems:"center",justifyContent:"center"},title:{fontWeight:500,fontSize:48,textAlign:"center"}},z=function(){return Object(j.jsx)("div",{style:_.container,children:Object(j.jsxs)("h1",{style:_.title,children:["Welcome page of the service"," "]})})},H=n(51),F=n(145),N=n(144),D={name:"",email:"",password:""},J=function(){var e=Object(s.b)(),t=Object(a.useCallback)((function(e){var t={};return e.name?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(t.email="Invalid email address"):t.name="Required",t}),[]),n=Object(a.useCallback)((function(t,n){var a=n.setSubmitting;setTimeout((function(){a(!1)}),400),e(B.register(t))}),[e]);return Object(j.jsxs)("div",{style:{marginLeft:"40px",width:"400px"},children:[Object(j.jsx)("h1",{children:"Registration"}),Object(j.jsx)(H.a,{initialValues:D,validate:t,onSubmit:n,children:function(e){var t=e.values,n=e.errors,a=e.touched,r=e.handleChange,c=e.handleSubmit,o=e.handleBlur,i=e.isSubmitting;return Object(j.jsxs)("form",{onSubmit:c,autoComplete:"off",children:[Object(j.jsx)(N.a,{fullWidth:!0,id:"name",name:"name",label:"Name",type:"text",value:t.name,onChange:r,onBlur:o,error:a.name&&Boolean(n.name),helperText:a.name&&n.name}),Object(j.jsx)(N.a,{fullWidth:!0,id:"email",name:"email",label:"Email",type:"email",value:t.email,onChange:r,onBlur:o,error:a.email&&Boolean(n.email),helperText:a.email&&n.email}),Object(j.jsx)(N.a,{fullWidth:!0,id:"password",name:"password",label:"Password",type:"password",value:t.password,onBlur:o,onChange:r,error:a.password&&Boolean(n.password),helperText:a.password&&n.password}),Object(j.jsx)(F.a,{color:"primary",variant:"contained",fullWidth:!0,type:"submit",disabled:i||!(Object.keys(a).length===Object.keys(D).length&&0===Object.keys(n).length),children:"Submit"})]})}})]})},P={email:"",password:""},$=function(){var e=Object(s.b)(),t=Object(a.useCallback)((function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Required",t}),[]),n=Object(a.useCallback)((function(t,n){var a=n.setSubmitting;setTimeout((function(){a(!1)}),400),e(B.logIn(t))}),[e]);return Object(j.jsxs)("div",{style:{marginLeft:"40px",width:"400px"},children:[Object(j.jsx)("h1",{children:"Login"}),Object(j.jsx)(H.a,{initialValues:P,validate:t,onSubmit:n,children:function(e){var t=e.values,n=e.errors,a=e.touched,r=e.handleChange,c=e.handleSubmit,o=e.handleBlur,i=e.isSubmitting;return Object(j.jsxs)("form",{onSubmit:c,autoComplete:"off",children:[Object(j.jsx)(N.a,{fullWidth:!0,id:"email",name:"email",label:"Email",type:"email",value:t.email,onChange:r,onBlur:o,error:a.email&&Boolean(n.email),helperText:a.email&&n.email}),Object(j.jsx)(N.a,{fullWidth:!0,id:"password",name:"password",label:"Password",type:"password",value:t.password,onBlur:o,onChange:r,error:a.password&&Boolean(n.password),helperText:a.password&&n.password}),Object(j.jsx)(F.a,{color:"primary",variant:"contained",fullWidth:!0,type:"submit",disabled:i||!(Object.keys(a).length===Object.keys(P).length&&0===Object.keys(n).length),children:"Submit"})]})}})]})},M=function(){return Object(j.jsx)(h,{children:Object(j.jsx)("h1",{children:"ContactsView"})})},G=n(34),K=n(54),Q=["component"],X=function(e){var t=e.component,n=Object(K.a)(e,Q),a=Object(s.c)(A.getIsLoggedIn);return Object(j.jsx)(u.b,Object(G.a)(Object(G.a)({},n),{},{render:function(e){return a?Object(j.jsx)(t,Object(G.a)({},e)):Object(j.jsx)(u.a,{to:"/login"})}}))},Y=["component"],ee=function(e){var t=e.component,n=Object(K.a)(e,Y),a=Object(s.c)(A.getIsLoggedIn);return Object(j.jsx)(u.b,Object(G.a)(Object(G.a)({},n),{},{render:function(e){return a?Object(j.jsx)(u.a,{to:"/"}):Object(j.jsx)(t,Object(G.a)({},e))}}))},te=function(){var e=Object(s.b)();return Object(a.useEffect)((function(){e(B.fetchCurrentUser())}),[e]),Object(j.jsxs)(h,{children:[Object(j.jsx)(V,{}),Object(j.jsxs)(u.d,{children:[Object(j.jsx)(ee,{component:z,exact:!0,path:"/"}),Object(j.jsx)(ee,{component:J,path:"/register"}),Object(j.jsx)(ee,{component:$,path:"/login"}),Object(j.jsx)(X,{component:M,path:"/contacts"})]})]})},ne=n(53),ae=n(31),re=n(75),ce=n.n(re),oe=n(22),ie=n(18),se=(Object(y.b)("contacts/fetchContactsRequest"),Object(y.b)("contacts/fetchContactsSuccess")),le=(Object(y.b)("contacts/fetchContactsError"),Object(y.b)("contacts/addContactRequest"),Object(y.b)("contacts/addContactSuccess")),ue=(Object(y.b)("contacts/addContactError"),Object(y.b)("contacts/deleteContactRequest"),Object(y.b)("contacts/deleteContactSuccess")),be=(Object(y.b)("contacts/deleteContactError"),Object(y.b)("contacts/changeFilter")),de=Object(y.d)([],(E={},Object(oe.a)(E,se,(function(e,t){return t.payload})),Object(oe.a)(E,le,(function(e,t){var n=t.payload;return[].concat(Object(ne.a)(e),[n])})),Object(oe.a)(E,ue,(function(e,t){var n=t.payload;return e.filter((function(e){return e.id!==n}))})),E)),je=Object(y.d)("",Object(oe.a)({},be,(function(e,t){return t.payload}))),he=Object(ie.b)({items:de,filter:je}),pe=Object(y.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1},extraReducers:(T={},Object(oe.a)(T,B.register.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0})),Object(oe.a)(T,B.logIn.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0})),Object(oe.a)(T,B.logOut.fulfilled,(function(e,t){e.user={name:null,email:null},e.token=null,e.isLoggedIn=!1})),Object(oe.a)(T,B.fetchCurrentUser.fulfilled,(function(e,t){e.user=t.payload,e.isLoggedIn=!0})),T)}).reducer,Oe=Object(ne.a)(Object(y.f)({serializableCheck:{ignoredActions:[ae.a,ae.f,ae.b,ae.c,ae.d,ae.e]}})),fe={key:"auth",storage:ce.a,whitelist:["token"]},me=Object(y.a)({reducer:{auth:Object(ae.g)(fe,pe),contacts:he},middleware:Oe,devTools:!1}),ge=Object(ae.h)(me);n(113);o.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(s.a,{store:me,children:Object(j.jsx)(l.a,{loading:null,persistor:ge,children:Object(j.jsx)(i.a,{children:Object(j.jsx)(te,{})})})})}),document.getElementById("root"))},71:function(e,t,n){e.exports={container:"Container_container__36VH0"}}},[[114,1,2]]]);
//# sourceMappingURL=main.ea6d537a.chunk.js.map